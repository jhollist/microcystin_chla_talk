<!DOCTYPE html>
<html>
  <head>
    <title>Using Chlorophyll a as a surrogate for exceeding Microcystin Health Advisory Concentrations</title>
    <meta charset="utf-8">
    <meta name="author" content="Jeff Hollister and Betty Kreakie" />
    <link href="libs/remark-css-0.0.1/example.css" rel="stylesheet" />
    <link href="libs/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="custom.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Using Chlorophyll <em>a</em> as a surrogate for exceeding Microcystin Health Advisory Concentrations
## Cyanobacteria - Monitoring and Treating Drinking Water: A Workshop for Water Suppliers
### Jeff Hollister and Betty Kreakie
### <div style="white-space: pre-line;">2017-12-014
Worcester, MA</div>

---







class: center, middle, inverse

# Problem: What is a bloom?

---

# Problem: What is a bloom?

## So of course, I asked Twitter

![](tweet1.jpg)
---

# Problem: What is a bloom?

## Got some of this variety

![](tweet2.jpg)

![](tweet3.jpg)

---

# Problem: What is a bloom?

## Got some of the more quantitative

![](tweet5.jpg)

---

# Problem: What is a bloom?

## And then the one closest to reality

![](tweet6.jpg)

---

# Problem: What is a bloom?

## Take away message

- No real concensus
- Should be relative to some baseline
  - Clarity?
  - Public concern?
  - Health risk?
- Still left with a decision

---

# Problem: What is a bloom?

## What could we use?

- Toxins?
  - Most direct measure
  - Data few and far between
- Cell counts, bio-volume, etc.
  - Myriad problems
- Chlorophyll
  - Available
  - Associated with cyanobacteria?

---
class: center, middle, inverse

# Possible Solution: Chlorophyll as a proxy for Microcystin

---

# Possible Solution: Chlorphyll as a proxy

.left-column[
- 2007 NLA show association
- Yuan *et al* (2014). Freshwater Biology 
- But, what is a bloom?
]

.right-column[

&lt;img src="hollister_kreakie_fig2.gif" style="margin-top: 80px; width: 90%; height: 90%;"&gt;&lt;/img&gt;

.image-credit[Hollister and Kreakie. (2016). https://f1000research.com/articles/5-151/v2]

]
---

# Possible Solution: Chlorphyll as a proxy

## Exsiting Microcystin Advisory Levels 

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; Source &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Type &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Concentration &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; USEPA &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Child Drinking Water Advisory &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.3 µg/L &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; WHO &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Drinking Water &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1 µg/L &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; USEPA &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Adult Drinking Water Advisory &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1.6 µg/L &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; WHO &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Recreational: Low Prob. of Effect &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2-4 µg/L &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; WHO &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Recreational: Moderate Prob. of Effect &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 10-20 µg/L &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; WHO &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Recreational: High Prob. of Effect &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 20-2000 µg/L &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; WHO &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Recreational: Very High Prob. of Effect &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &amp;gt;2000 µg/L &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---
class: center, middle, inverse

# Our Solution: Chlorophyll and Microcystin

---

# Our Solution: Chlorophyll and Microsystin

## Assocation chlorohpyll a  concentration with Microcystin guidance levels

- Conditional probability 
    - Probability of one event happening, given another has already happened
    - Our approach based entirely on data
    - History in environemntal applications
- Data
    - 2007 NLA
    - EPA and WHO guidance levels

---

# Results: Chlorophyll and Microsystin

![](hollister_kreakie_fig1.gif)

---

# Results: Chlorophyll and Microsystin

## Results

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;"&gt; Cond. Probability &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; USEPA Child (0.3 µg/L) &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; WHO Drink (1 µg/L) &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; USEPA Adult (1.6 µg/L) &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; WHO Recreational (2 µg/L)  &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 0.1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.07 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.07 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.07 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 0.2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.07 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.00 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9.00 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 17 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 0.3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.00 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 17.00 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 27.00 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 50 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 0.4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 12.00 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 39.00 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 66.00 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 82 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 0.5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 23.00 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 65.00 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 84.00 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 115 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 0.6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 40.00 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 92.00 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 126.00 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 167 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 0.7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 66.00 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 126.00 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 245.00 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 256 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 0.8 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 123.00 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 228.00 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 871.00 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 871 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 0.9 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 170.00 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 338.00 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 871.00 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 871 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---

# Our Solution: Chlorophyll and Microsystin

## Validation with 2012

- How did it work finding exceedances?


```r
nla12_tox &lt;- read_csv("https://www.epa.gov/sites/production/files/2016-11/nla2012_algaltoxins_08192016.csv") %&gt;%
  select(UID, MICL_RESULT)
```

```
## Parsed with column specification:
## cols(
##   .default = col_character(),
##   UID = col_integer(),
##   VISIT_NO = col_integer(),
##   MICL_HOLDING_TIME = col_integer(),
##   MICL_MDL = col_double(),
##   MICL_RESULT = col_double(),
##   MICL_RL = col_double(),
##   MICX_HOLDING_TIME = col_integer(),
##   MICX_MDL = col_double(),
##   MICX_RESULT = col_double(),
##   MICX_RL = col_double(),
##   MICL_SAMPLE_ID = col_integer(),
##   MICX_SAMPLE_ID = col_integer()
## )
```

```
## See spec(...) for full column specifications.
```

```r
nla12_chla &lt;- read_csv("https://www.epa.gov/sites/production/files/2016-11/nla2012_chla_wide.csv") %&gt;%
  select(UID, CHLL_RESULT)
```

```
## Parsed with column specification:
## cols(
##   .default = col_character(),
##   UID = col_integer(),
##   CHLL_DILUTION_FACTOR = col_integer(),
##   CHLL_EXTRACT = col_double(),
##   CHLL_HOLDING_TIME = col_integer(),
##   CHLL_MDL = col_double(),
##   CHLL_RESULT = col_double(),
##   CHLL_RL = col_double(),
##   CHLL_SAMPLEVOL = col_integer(),
##   CHLL_VOLUME_ADJUST = col_integer(),
##   CHLX_DILUTION_FACTOR = col_integer(),
##   CHLX_EXTRACT = col_double(),
##   CHLX_HOLDING_TIME = col_integer(),
##   CHLX_MDL = col_double(),
##   CHLX_RESULT = col_double(),
##   CHLX_RL = col_double(),
##   CHLX_SAMPLEVOL = col_integer(),
##   CHLX_VOLUME_ADJUST = col_double()
## )
## See spec(...) for full column specifications.
```

```
## Warning: 1 parsing failure.
## row # A tibble: 1 x 5 col     row                col               expected actual expected   &lt;int&gt;              &lt;chr&gt;                  &lt;chr&gt;  &lt;chr&gt; actual 1  1041 CHLL_VOLUME_ADJUST no trailing characters     .5 file # ... with 1 more variables: file &lt;chr&gt;
```

```r
nla12 &lt;- full_join(nla12_chla, nla12_tox) %&gt;%
  na.omit() %&gt;%
  mutate(child_cp_exceed = CHLL_RESULT &gt;= 23,
         actual_exceed = MICL_RESULT &gt;= 0.3)
```

```
## Joining, by = "UID"
```

```r
ta_perc &lt;- 100*sum(nla12$child_cp_exceed==nla12$actual_exceed)/nrow(nla12)
fn_perc &lt;- 100*sum(nla12$child_cp_exceed == 0 &amp; nla12$actual_exceed == 1)/nrow(nla12)
```


---
class: center, middle, inverse

# Applications and Caveats

---

# Applications and caveats

## How to use

- Research applications
- Screening tool

---

# Applications and caveats

## Important considerations

- It is just a surrogate
- Probability of exceeding is managment decision
- These numbers based on national data
- Individual lakes will have different relationshis

---

# Animated GIF

### and stuff

![animated gif](https://media.giphy.com/media/kP3cKoaFwUFA4/giphy.gif)

---
# Thanks!
.center[
## Jeff Hollister
US EPA &lt;/br&gt;
Atlantic Ecology Division &lt;/br&gt;
Narragansett, RI &lt;/br&gt;

<i class="fa  fa-envelope "></i>: [hollister.jeff@epa.gov](mailto:hollister.jeff@epa.gov) &lt;/br&gt;
<i class="fa  fa-twitter "></i>: [jhollist](https://twitter.com/jhollist) &lt;/br&gt;
<i class="fa  fa-github "></i>: [jhollist](https://github.com/jhollist) &lt;/br&gt;

Slides created via the R package [**xaringan**](https://github.com/yihui/xaringan).
]
    </textarea>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": true
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {window.dispatchEvent(new Event('resize'));});</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre']
  }
});
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
